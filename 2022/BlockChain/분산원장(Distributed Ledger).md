# 분산원장


## 분산 데이터베이스란?

분산 데이터베이스는 한 개의 데이터베이스 관리 시스템을 사용해 여러 CPU에 연결된 저장장치들을 제어하는 형태의 데이터베이스이다.

노드는 물리적으로 떨어져있지만 논리적으로는 한 개인것처럼 활용한다는 것이 핵심 개념이다. 이때 각가의 저장소를 노드라고 부른다.

분산 데이터베이스는 물리적으로 떨어진 여러 컴퓨터를 다뤄야하기 때문에 투명성을 확보하는 것이 가장 중요하다.

분산 데이터베이스의 투명성은 아래와 같이 6가지 관점에서 바라볼 수 있다.

```
- 병행 : 다수의 트랜잭션 수행시 결과가 일관성 유지 = 지원처리 양,속도 개선
- 장애 : 장애. 발생시 all or Nothing 유지(원자성 유지) = 데이터 일관성
- 지역사상 :  개발 지역의 물리적 이름과 관계없이 접근가능 = 확장성 확보
- 위치 : 데이터를 물리적 저장 위치가 아닌 논리적 입장에서 접근 = 생산성, 활용성 강화
- 중복 : 데이터를 지역별로 중복 저장하여도 데이터 처리 가능 = 병목현상 해소
- 분할 : 물리적 구조가 여러 단편으로 분할 저장되어 논리적 사용 = 성능향상
```

----------------------------------

### 분산데이터베이스의  대표적 기술 

```
- 클러스트링 
- 래플리케이션
- 샤딩
```

#### 클러스트링 : 서버를 여러개로 만들자

```
장점 : 다른 서버가 죽어도 또다른 서버가 역할을 대신해서 서비스 지속가능
단점 : 데이터베이스는 1개 이기에 병목현상이 발생할 수도 있음 + 비용
```

#### 래플리케이션 : 데이터가 손실되면 어떻게할까 -> 데이터베이스 스토리지도 여러개로 하자

```
장점 : 데이터베이스 성능을 높일 수 있다 + 비동기 여서 지연시간이 없다.
단점 : 각 노드 간의 데이터 동기화 보장이 어려움 + Master 노드가 다운되면 복구 , 대처가 어렵다.
```

#### 샤딩  : 테이블을 나누어서 저장하자

```
장점 : 서버의 수평적 확장 + 쿼리 반응속도 빨라짐
단점 : 데이터를 적절히 분리하지 못하면 샤딩보다 비효율적 + 한번 분할되면 이전으로 합치기 까다롭다.
```

##### 샤딩의 종류

```
해시 샤딩 : 샤딩 수만큼 해싱 - 구현이 간단하나 샤드가 늘어나면 해시 함수가 달려져야해서 확장성은 떨어짐
다이나믹 샤딩 : 샤드가 추가되면 Locator service에 shard key를 추가하는 방식으로 확장성 up 이지만 테이블에 문제가 생기면 데이터베이스에도 문제가 전이된다.(의존적이라)
엔티티 그룹 샤딩 : 관계되어 있는 엔티티끼리 같은 샤드 내에 공유
엔티티 그룹 샤딩 장점 : 단일 샤드 내에서 쿼리가 효율적, 단일 샤드 내에서 강한 응집도 but 다른 샤드면 실행 효율이 떨어짐
```

----------------------------------

### 전체적인 분산데이터베이스의 장단점 

투명한 분산 : 분산 데이터베이스를 구성하는 노드들은 물리적으로 떨어져 있다.

그러나 사용자의 입장에서 분산 데이터베이스를 사용할 때는, 마치 단일한 데이터베이스를 사용하는 것과 동일하게 데이터를 처리할 수 있어야 한다.

투명한 트랜잭션 : 분산된 여러 노드들은 하나의 트랜잭션에 대해 일관성을 보장해야한다. 즉, 데이터 처리 요청이 들어왔을 때 일부 트랜잭션에만 적용되는 등 일관성이 깨지면 안된다. 트랜잭션은 일반적으로 여러 하위 트랜잭션으로 분리될 수 있다.

```
			장점 					단점 

		시스템의 가용성 확보 			트랜잭션 처리 알고리즘 복잡
		지역업무 특화 서비스제공		관리가 복잡 비용 증대
		시스템 확장 및 적응성			통신망 장애 시 부가적 피해 가능성
		장애에 대한 신뢰성 증진		잠재적 오류 내재 가능성
		지역별 자원 활용 및 확장성		설계 및 구현의 어려
```
----------------------------------

### 분산 데이터베이스와 블록체인의 차이점 

가장 큰 차이점은 
```
1. 악의적인 사용자를 전제하고 만들어짐 시스템(합의 알고리즘)
2. 운영 주체가 사라져도 시스템 유지 가능(거버넌스)
```

데이터를 분산시켜 저장한다는 시점에서 동일하지만, 특별히 악의 적인 사용자를 전제하지 않는다.

즉 , 사용하는 것에 더 중점을 두었지만 악의적인 사용자 큰 중점을 두지는 않았다는 것. 즉 , 재해복구 ,백업, 성능 상의 이점

블록체인 : 악의적인 사용자의 존재를 염두하고 개발

블록체인은 합의 과정을 통해서 악의 적인 사용자의 공격을 방지

```
1. 합의 알고리즘
2. 거버넌스
```

----------------------------------

### 분산원장 기술의 이해

여러 위치에서 여러 사람에 의해 복제, 공유 또는 동기화된 데이터베이스를 ㅎ바의하는 바식에 대한 기술

즉 , P2P 네트워크에 분산하여 참가자가 공동으로 저장하고 기록하는 기술

분산원장을 구현하기 위해 P2P 네트워크와 각 노드가 가지는 데이터 사본을 위한 합의 알고리즘을 필요로함.

즉 분산 원장 기술은 P2P 네트워크로 연결된 각 노드가 데이터베이스가 되는 것이기 때문에, 분산 데이터베이스의 한 종류이다.

분산원장은 이미 많은 기업에서 사용중이다.

기업에서는 트랜잭션 또는 기타 유형의 데이터를 교환할 때 분산 원장 기술을 이용해 해당 데이터를 처리, 검증 또는 인증한다.

특히 많은 은해에서 분산 원장 기술에 대해 연구 및 투자를 진행중이다.

블록체인은 이러한 분산원장 기술의 한 종류이다.

근래 소유권을 보관하는 원장에 기록하여 관리하였다.

### 중앙집중형 원장(Centralized ledger)

장점 : 비용 절감하고 소유권을 명확히 할 수 있다.


#### 중앙집중형 원장의 단점 : 

신뢰에 크게 의존해야한다.높은 수수료를 부담으로 한다.

----------------------------------

### 분산원장 

분산원장은 다음과 같은 장점을 가진다.
효율성 (Efficiency) : 신뢰를 위해 비용을 쓰지 않아도 된다. 해킹, 오류 보안 사고 등 방지
보안성 (Security) : 악의적인 공격에 안전, 애초에 모두 공개하기 때문에
시스템 안정성(Resilience) : 단일 실패점 이 존재하지 않기 때문에 일부 노드에 오류 또는 성능 저하가 발생해도 전체는 안전하다.
투명성(Transparency) : 분산원장 기술은 모든 거래 기록을 공개하기 때문에 높은 투명성을 가진다.

단점 

분산원장 기술에서는 신뢰를 담보해 줄 외부 기관 등이 존재하지 않기 때문에 시스템자체에서 신뢰를 형성하는 매커니즘이 필요하다.
