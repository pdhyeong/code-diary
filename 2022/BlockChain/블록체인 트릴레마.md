블록체인 트릴레마(딜레마)


블록체인은 기존의 중앙집중적인 네트워크와 비교하기에는 무리가 있다.

보편적으로 사용되기에는 해결해야될 문제가 많아서 이다.

블록체인은 확장성(Scalability) 보안(Security), 탈중앙성(Decentralization) 중 하나를 희생해야하는 문제를 가지고 있다.
이런 문제를 트릴레마(Trilemma)라고함.

비트코인은 탈중앙화 되어있고, 안전하지만 초당 약 7TPS만 처리 가능

반면 하이퍼레져 패브릭 같은 엔터프라이즈 블록체인은 안전하고 높은 트랜잭션을 처리할 수 있지만, 매우 제한된 수의 노드로 구성된 중앙 집중적 구조

하이퍼레져 패브릭처럼 대규모의 트랜잭션을 처리 하는 동시에 비트코인처럼 광범위하게 탈중앙화된 네트워클르 통해 완벽한 보안을 제공하는것이 과연 가능할까

오늘날 이러한 문제를 해결하기 위해 다양한 기업 과 글로벌 커뮤니티에서 레이어 솔루션을 개발중


트릴레마란 

선택해야길은 3개인데 어느쪽을 선택해도 남은 두 가지 또는 한 가지의 문제를 악화시키는 상황을 의미한다.

블록체인은 이 트릴레마에 직면해있다.

확장성(Scalability), 보안성(Security), 탈중앙성(Decentralization) 모두를 만족시키는 것이 가장 이상적이지만 현실적으로는 한번에 해결할 수 없음을 의미한다.

확장성(Scalability) :  사용자 수가 늘어나더라도, 유연하게 대응할 수 있는 정도를 나타냄.

보안성(Security): 블록체인 내의 데이터나 프로그램을 권한이 없는 이용자가 사용할 수 없도록 하는 것

탈중앙성(Decentralization): 중앙집권화를 벗어나 분산된 소규모 단위가 모여, 자율적 운영방식




확장성(Scalability)

확장성은 사용자 수의 수가 증가하거나 규모가 커지면 데이터 처리량이 얼마나 증가할 수 있는지를 정한다.


1)높은 트랜잭션 처리량


TPS(Transaction Per second) 

초당 트랜잭션 처리 속도로, 블록체인 네트워크의 성능지표로 사용된다.

비트, 이더는 확장성 문제로 초당 처리 트랜잭션 처리량이 낮다.

EOS는 약 3000TPS를 나타내지만 해결한 것은 아니다. 만약 dApp이 6000을 처리하면 이것마저 병목현상일테니…..



2)미래 증가량

해당 블록체인의 채택이 가속화되어도 성능이 저하되지 않아야한다.

디앱이나 토큰을 기획하는 개인 또는 회사가 해당 블록체인을 채택하는 일이 증가하면 할 수록, 성능이 저조해지는 블록체인은 확장성이 부족하다고 한다.

단순히 블록체인 네트워크의 성능을 더 높이면 된다고 생각할 수 도 있다.
하지만 더 큰 확장성을 가지려고 하면 할 수록 보안성과 탈중앙성을 확보하는 것이 점점 어려워진다.

많은 블록체인 플랫폼이 보안성과 탈중앙성을 확립했지만, 확장성을 달성하는 것은 오늘날의 주요 과제이다.


보안성(Security)

보안성은 데이터나 프로그램이 보호되어 있고, 권한이 없는 사용자나 악의적인 사용자의 접근을 막는 것을 뜻한다.

블록체인에서 보안성은 굉장히 중요하다. 코인이라는 합의과정을 통해 화폐를 발행하고, 탈중앙화된 분산 원장을 통해 화폐의 흐름을 관리한다. 

트랜잭션 처리량을 늘리기 위해 광범위하게 분산된 노드의 분포를 제한하면

필요한 해시 파워를 축적하여 51% 공격이 발생할 가능성이 높아진다.

이더리움 클래식은 3번의 51% 공격을 받은 적이 있는데, 보안성이 낮은 틈을타 해커가 네트워크를 가로채고 금전적 이득을 위해 거래를 조작한 사건이다.

비트코인과 이더는 합의알고리즘을 사용하여 보안성을 높였는데

합의알고리즘을 사용했다고 해서 완전히 벗어난건 아니다. 실제로 비트코인에서 하드 포크한 비트코인 골드와 이더리움에서 하드 포크한 이더리움 클랙은 51%을 당하기도 했다.

51% 공격의 핵심 : 네트워크 전체에 충분한 해시 파워가 있는가
새로운 네트워크로 인해 노드수가 적고 해시레이트가 낮아져서 가능했다.


탈중앙성(Decentralization) :

탈중앙성은 네트워크 클라이언트 ~ 서버 구조처럼 중앙집권화된 방식으로 운영되는 것이 아닌, 노드 간 자율적으로 운영되는 것을 말한다.

Ex) 금융상품에서 중앙집권식 중개자인 은행의 역할이 축소화 되면, De-Fi 플랫폼이 되며, 사용자로만 구성되어 더 많은 사람에게 이익을 분배할 수 있다.

근데 보통 탈중앙화를 달성하면 트랜잭션 처리량이 감소하는 경향이 있다.
확장성 문제가 걸리는것. 그 이유는 합의에 참여하는 채굴 노드들이 많아질수록 네트워크를 더 안전하게 보호 할 수 있지만, 합의에 도달하기까지 더 많은 시간이 소요되기 때문이다. 


### 세 요소의 상호작용의 한계

많은 노드 수는 탈중앙성을 강화하지만, 확장성을 저해한다.

세 가지 요소를 동시에 최적화할 수 없으며 상호간 절충이 필요하다.

한 요소를 강화하려면 중앙화/탈중앙화에 대한 대치관계를 형성해야한다.

탈 중앙성의 타협성은 확장성이다.

강력하게 분산된 비트코인은 확장성과 타협했기 때문에 매우 느리다.

장단점 :
```
확장성 중심 네트워크 장단점
장점:
- 네트워크가 많은 양의 트랜잭션을 지원할 수 있도록 한다.
- SNS 애플리케이션과 같이 보안이 주요 초점이 아닌 애플리케이션에서 유용하게 작용

단점 :
- 탈중앙성을 희생해야한다.
```

### 보안성 중심 네트워크 장단점
```
장점:
- 많은 노드 수와 높은 네트워크 해시 파워를 의미한다. 따라서 트랜잭션에 댜한 수수료가 낮은 가격으로 안정적.
- 퍼블릭 블록체인의 보안은 네트워크 참여자에게서 나온다. 높은 보안은 복제가 어렵다..

단점 :
- 노드 수가 많아야하고, 네트워크 해시 파워가 높아야 하기 떄문에 노드 운영비용이 비싸다. pow합의 방식을 채택한 경우 채굴로 인해 컴퓨터 연산 자원을 많이 소모하게 된다.
```

### 탈중앙 네트워크의 장단점

```
장점 :
- 탈중앙화를 통해 사용자가 단일 엔티티를 신뢰하지 않고도 합의를 유지하다.
- 분산 네트워크는 누구나 네트워크를 참여 할 수 있고, 네트워크에 참여하는 노드가 많아질 수록 더욱 분산화되기 떄문에, 중앙화된 노드가 네트워크 데이터에 대해 검열 할 수 없도록 한다. 이는 개인의 재산권, 다시 말해 개인이 자신의 자산을 제 삼자가 아닌 스스로 관리할 수 있도록 한다.

단점 : 
- 합의 알고리즘을 사용하는 분산 장부 네트워크에서는 노드 수가 많아질 수록 전체 네트워크가 합의 도달하느 ㄴ시간이 길어진다. 따라서 네트워크에서 처리할 수 있는 트랜잭션 양이 감소하게 되며 확장성 문제를 일으킨다.
- 중복성을 도입하기 때문에 비용이 많이 들고 모든 애플리케이션에는 바람직하지 않다.
```

레이어의 다양한 해소방안

레이어1은 블록체인을 개선하는 것
레이어2는 레이어1의 네트워크 위에서 작동하는 것을 의미한다.

----------------------------------------------------------------------

## 블록체인 트릴레마 해결 : 레이어 1(Layer-1) 솔루션

레이어 1은 블록체인 네트워크 자체를 의미한다.

대표적으로 우리가 알고 있는 비트코인, 이더리움과같은 블록체인을 말한다.

레이어1 솔루션은 기존의 블록체인의 규칙 또는 메커니즘을 직접ㅂ적으로 개선하는 것을 의미한다.

이러한 개선은 대부분 해당 블록체인을 직접적으로 개발하는 코어 팀에 의해 도입되는 경우가 많다.


### 합의 알고리즘 개선

비트코인과 이더리움은 둘 다 분산된 합의 알고리즘을 사용한다.

하나의 트랜잭션을 처리하기 위해 여러 노드의 검증이 필요하고, 대표 블록을 선정하기 위해 수많은 연산이 요구된다.

이러한 과정은 악의적인 공격에 비교적 안전하고 ,정확하고 검증된 데이터를 기록할 수 있다는 장점이 있지만, 속도가 느려서 더 많은 수요를 감당할 수 없다.

즉 Pow는 안전하지만 확장성이 떨어진다. 

그러한 이유로 블록체인 네트워크가 지분 증명으로(Pos) 전환을 시도하고 있다. 채굴자가 상당한 컴퓨팅 연산을 사용하여 암호화 알고리즘을 해결하도록 요구하는 Pow대신, PoS 합의 알고리즘은 네트워크 지분을 기반으로 검증인 상태를 결정하기 떄문에 네트워크의 용량을 극적이고 근본적으로 증가시키는 동시에 탈중앙화를 높이고 보안을 보장할 것으로 예상된다.


### 샤딩(Sharing)

샤딩은 기존 분산 데이터베이스에서 활용되는 솔루션이지만, 블록체인에도 도입되었다.

다소 실험적인 특성에도 현재 가장 인기 있는 레이어 1확장 솔루션이다.

샤딩은 트랜잭션을 샤드라고 하는 더 작은 데이터로 나눈다.
이러한 샤드는 네트워크에서 동시에 병렬로 처리되므로 동시에 수많은 트랜잭션에 대한 순차적 작업이 가능하다.

 또한 각  네트워크에서 노드가 제네시스의 모든 블록 사본을 보유하도록 하는 대신, 서로 다른 노드에 의해 분할되고 유지 될수 있게 하며 각 노드는 그 자체로 일관성을 유지한다.

샤드는 메인 체인에 증거를 제공하고 교차 샤드 통신 프로토콜을 사용하여 ,주소, 잔액 및 일반 상태를 공유하기 위해 상호작용한다.

----------------------------------------------------------------------

## 블록체인 트렐리마 해결: 레이어 2 솔루션

레이어2는 다른 블록체인 위에 구축된 네트워크를 의미한다.

이는 레이어 1 블록체인 위에서 작동하며, 확장성과 효율성을 향상하는 네트워크 또는 기술을 의미한다.

예를들어 비트코인은 레이어1 블록체인이고 라이트닝 네트워크는 비트코인 네트워크에서 트랜잭션 속도를 향상 시키기 위해 구축된 레이어 2 솔루션이다.

레이어2는 최근 몇년동안 엄청나게 성장했고 PoW 네트워크의 확장성 문제를 극복하는 효율적인 방법이다.


### 롤업(RollUp)

롤업은 레이어1 외부에서 트랜잭션을 실행하지만, 레이어 1에 트랜잭션 데이터를 저장하는 방식이다.
롤업은 레이어 1 블록체인의 보안성은 건들지 않으면서도 확장성을 강화할 수 있다는 장점이있다.

동작방식은
```
1. 레이어 외부에서 트랜잭션 실행
2. 트랜잭션 데이터는 레이어 1에 저장
3. 레이어 1의 트랜잭션 데이터를 사용하여 레이어2에서 올바른 트랜잭션 실행할 수있는 롤업 스마트 계약
```

롤업 기술은 대표적으로 2가지로 나뉘는데

옵티미스틱 롤업(Optimistic Rollup) 와 ZK롤업 (Zero Knowledge Rollup)이다.

옵티미스틱 롤업은 애플리케이션이 바로 상호작용하게 해주어서 누구나 레이어 1 클론에 연결할 수 있지만 ZK 롤업은 자체 환경에서 독립적으로 존재하기 때문에 사용자들이 자체 롤업으로 애플리케이션에 연결해야한다.

----------------------------------------------------------------------

### 중첩 블록체인

중첩 블록체인은 메인 블록체인을 활용하여 더 넓은 네트워크에 대한 매개변수를 설정하고 , 실행은 보조 체인의 상호 연결된 웹에서 수행되는 분산형 네트워크 인프라이다.

부모 체인 대리자는 자식 체인의 작업 결과를 다시 부모에게 보내는 작업을 수행한다.

기본 블록체인은 분쟁 해결이 필요한 경우 아니면 네트워크 기능에 참여하지 않는다.

레이어2 중첩 블록체인 인프라의 대표적인 예로 OMG Plasma 프로젝트가 있다. 빠르고 저렴한 거래를 촉진하기 위해 만들은 프로젝트

작업 분배는 메인체인의 처리 부담을 줄여 확장성을 기하급수적으로 향상 시킨다.

----------------------------------------------------------------------

### 상태 채널

두 사용자의 간의 커뮤니케이션을 위한 양방향 채널로서, 전체 트랜잭션 용량과 속도를 개선하기 위해 다양한 매커니즘을 사용하여 블록체인과 오프체인 트랜잭션 채널간의 양방향 통신을 용이하게 한다.


상태 채널은 트랜잭션을 검증하는 채굴 노드의 개입이 필요하지 않다.
상태 채널은 다중 서명 또는 스마트 계약 매커니즘을 사용하여 봉인된 네트워크 인접 리소스이기 때문에

상태 채널을 엸어서 참가자 간에 오프체인 트랜잭션을 수행 후, 최종 결과에 해당하는 트랜잭션을 메인체인에 반영하여 기록한다.

대표적으로 비트코인 라이트닝 네트워크,이더리움의 라이덴 등이 상태 채널의 예이다.

----------------------------------------------------------------------

### 사이드 체인

사이드 체인은 기존 블록체인의 확장성 개인을 위해 만들어진 체인. 블록체인 옆에서 대신 트랜잭션을 처리하는 역할이다.

예를 들어, 기존에는 메인 체인에서 발행된 코인이나 토큰은 무조건 메인 체인을 통해서 거래를 해야해서 느린속도와 비싼 수수로를 부담해야했다.

사이드 체인은 이런 문제를 해결한다. 메인체인의 output 주소와 input주소를 가지고 있다.

거래 당사자가 사이드 체인의 output 주소로 자신의 코인을 보내면 ,메인 체인에서 해당 코인은 사용할수 없도록 잠근다.
대신 동일한양의 코인이 사이드 체인의 거래 당사자 주소로 발행된다.

사용자는 비교적 높은 확장성을 가진 사이드 체인에서 거래를 진행한다. 거래를 완료 후, 사이드 체인에 있는 자신의 코인을 메인 체인으로 올리고 싶다면 메인체인에 있는 사이드 체인의 input 주소로 요청을 보내면 된다.

독릭적인 네트워크로 존재하는 동시에 , 메인 체인의 확장성 문제를 해결하는데 사용된다.


레이어1, 레이어 2 솔루션 모두 각가의 장단점이 존재하지만 

레이어1 솔루션은 대규모 네트워크 개선을 효과적으로 하지만 기존 채굴자들 입장에서는 인센티브 축소가 일어나는 여지가 있다.

레이어 2 솔루션은 훨씬 빠르게 확장성을 향상 할 수 있지만, 사용하는 방법에 따라 기존 블록체은의 보안성을 희생해야할 수도 있다.

이미 운영중인 블록체인을 개선하는 일은 쉽지 않은 일이다. 이런 솔루션이 확장성 트릴레마를 해결 못할 수도 있기때문에

가장 좋은 솔루션은 이러한 솔루션이 내장된 새로운 블록체인(프로토콜)을 만드는것.이다.

----------------------------------------------------------------------

## 확장성을 타협한 암호화폐

### 비트코인

비트코인은 높은 탈중앙화와 보안을 갖추고 있다.

하지만 확장성의 한계로 인해 트릴레마를 극복하지 못한다.

비트코인은 설계부터 탈중앙화와 보안에 집중하였으며, 보안 측면에서는 최고의 암호화폐이다.

하지만 노드수를 줄이거나 노드 일부만 검증하는 방식을 적용하면 네트워크 전체가 흔들려 그냥 트랜잭션 처리 속도를 포기했다.


### 이더리움

비트코인의 다음 세대로 불리는 이더리움 또한 확장성 문제에 부딪혔다.

현재 이더리움은 이더리움 플랫폼 위의 dApp 상에서 이루어지는 거래를 1초에 20건 밖에 처리할 수 없는 속도이다.

이더리움2.0은 Pow대신 Pos 방식과 샤딩 기술을 밭탕으로 실생활에서 이더리움을 사용할 수 있는 수준까지 끌어올릴 수 있다고 한다.

지분증명은 암호화폐를 보관하면 보관 지분에 따라 채굴 가능성이 올라가, 채굴 과정에서 컴퓨터 연산 비용이 릴요하지 않고 블록체인 네트워크 수수료가 낮아지는 효과를 기대할 수 있다.

이더리움 2.0에서 핵심 기술은 샤딩인데

트랜잭션 처리 속도를 높이기 위한 기술로 , 지분 증명의 검증자를 소규모 그룹으로 분리해 각 그굴빙 서로 다른 이더리움 트랜잭션을 동시 다발적으로 처리하는 방식.

----------------------------------------------------------------------

### 이더리움 확장성 문제에 직면하다.

이더리움 거래 속도는 20TPS이다. 이는 비자카드와 같이 초당 6,000건 이상 처리 할 수 있는 지불수단과 비교가 안된다.

이더리움은 지불 수단만 국한된것 보다는 계약서를 프로그래밍 코드 형태로 블록체인 상에 저장하고 조건을 만족하면 자동으로 실행 시켜 트랜잭션을 생성하는 스마트 컨트랙트 기능도 있다.

근데 이더리움은 계약화된 프로그램을 실행하기 위해 적지 않은 리소스를 지속해서 사용해야한다. 이 리소스는 결국 이더리움의 블록을 생성하는 채굴 노드가 감당해야하는 것으로 무한정으로 공급이 불가능하다.

이런 이유로 이더리움에서는 트랜잭션 실행 비용으로 가스 (Gas)방식의 수수료를 설정한다.
한 개의 블록이 만들어질 때, 비트코인과 같이 블록사이즈는 정해져있지 않지만, 리소스 할당에 상응하는 한계를 정해 놓기 위해 수수료 명목으로 최대치(Gas limit)가 670만으로 정해져 있다.


하지만 가스 수수료가 모든 문제를 해결할 수는 없었는데, 전체 네트워크의 하루 트랜잭션 중 20%를 차지 하며 전체 네트워크 속도가 떨어지고 거래 비용인 수수료가  상승하는 문제가 일어난적이 있는데 한정되어있는 트랜잭션 처리량이 있는데 더 많은 트랜잭션이 브로드캐스팅 되면, 네트워크에 과부하 및 병목현상이 발생하게 된다.
그리고 여러 트랜잭션 중 가스 수수료를 많이 받을 수 있는 트랜잭션을 우선적으로 처리해야 가스 수수료 인플레이션이 발생하게 된다.

이더리움은 약 20,000개의 노드로 비트코인의 비해 약 2배 가까이 많은 노드가 운영되고 있다.

분산화된 네트워크 형태를 잘 유지 중이어서 데이터 위변조에 대한 보안성과 탈중아화 측며네서 비교적 성공적인 생태계를 만든 것으로 평가된다.

이유로 dApp 생태계의 조성이라는 측면을 간과할 수는 없지만 위에서 설명한 것과 같이 dApp이 활성화 되면 될수록 스마트 컨트랙트의 증가와 수수료의 가중 문제는 이더리움 확장성에 치명적인 장매물로 인식될 수 있다.

이를 극복하기 위해 이더리움 재단은 다양한 시도를 차근차근하는중이다.
```
1. 블록에 거래가 포함 될때 속도의 지연
2. 합의 노드 간 합의 과정에 드는 속도의 지연 문제

1. 의 경우 블록 생성주기, 데이터 크기 등 블록체인 플랫폼 구조에 기인한 수수료와 리소스 할 당의 문제
2. 는 합의 알고리즘과 네트워크 확장성 요구에 따른 네트워크 자체의 문제로 볼 수있다.
```
비트코인은 1 의 문제에서 쉽게 접근해서 개선안을 도출가능하지만, 2 는 기존의 채굴업체들의 권력화로 인해 변경이 어렵다.

이더리움은 스마트 컨트랙트와 dApp 생태계 조성이라는 명제 때문에 2 의 관점에서 개선안을 도출하는 것이 쉽지만 1의 관점에서의 확정성 확보가 어렵다.

그래서 이더리움은 2측면에서 CASPER 알고리즘을 이용한 Pos 를 적용하고 샤딩에서 발생하는 리소스의 한계로 인해 본질적인 해결 방법을 제안하기 쉽지 않다보니, 블록에 포함 되는 정보의 양을 줄여나가는 방법으로 확장성을 확보하려고한다.




탈중앙화를 타협한 암호화폐


### 이오스(EOS)

3세대 플랫폼 EOS는 이더리움과는 다른 방향으로 확장성 문제를 극복하려고한다.

이오스는 불특정 다수의 합의 노드 참여를 제한하는 위임지분증명(DPos) 합의 알고리즘을 채택하여 탈중앙화와 확장성 문제를 해결하려고한다.

DPos 방식은 전체 코인 보유자들이 21명의 블록생성자 (BP)를 선출후, 그들에게 블록체인의 운영을 맡기는 방식이다.

이는 각 노드가 가진 이오스 코인에 대한 지분 투표를 통해 대표 노드에게 위임함으로써 민주적인 의사결정 시스템을 가진다는 점과 대표 노드를 견제할 수 있다는 점에서 탈중앙화를 추구한다고 볼 수 있다.

선출된 21개 노드만 검사하기 때문에 거래를 검증하면 더욱 빠른 연산이 가능하다.

선출된 21명의 대표 노드만 합의과정에 참여함으로써 트랜잭션 처리속도, 즉 확장성 문제의 해결을 추구한다.

하지만 이는 블록생성자의 권한은 시간이 지날수록 성장하게 될 것이고 그렇게 되면 탈중앙화(Decentralization)에서 벗어난다고 볼 수 있다.



### 하이퍼레저

비트코인 과 같은 퍼블릭 블록체인 모델은 누구나 참여할 수 있다. 하지만 참여자를 제한하는 새로운 모델로 프라이빗 블록체인이 등장했다.  하이퍼 레저는 기업용 블록체인 기술 개발을 위한 오픈소스 프로젝트이다.

참여 자체가 사전 승인이 필요하고, 신원이 모두 밝혀져 익명성도 없고 시스템 전체를 관리하는 중앙관리 주체가 있다.

프라이빗 블록체인과 컨소시엄 블록체인을 합쳐서 허가형(Permissioned) 블록체인이라고도 한다.

높은 수준의 보안성이 필요한 정보에서도 프라이빗 블록체인형태로 도입하려고한다.

탈중앙화에서 타협본다는 것은 채굴 노드의 수를 제한 해서 극적인 성능향상을 달성하는 것이다.

----------------------------------------------------------------------

### 하이브리드와 컨소시엄

하이브리드 블록체인과 컨소시엄 블록체인은 같은 것처럼 보일 수 있지만, 실제로는 다르다ㅏ. 컨소시엄 블록체인과 하이브리드 블록체인 모두 다른 접근방식을 사용하며 고유한 특성이 있다.

### 컨소시엄 블록체인

네트워크를 관리하는 그룹이 있다. 허가 받은 사용자만 네트워크에 참여가능하다.


### 하이브리드 블록체인

하이브리드 블록체인은 퍼블릭 블록체인과 프라이빗 블록체인을 합친 형태이다. 퍼블리 블록체인과 프라이빗 블록체인은 정반대의 개념 같은데, 어떻게 합칠까? 하면 하이브리드 블록체인은 사설 네트워크에서 호스팅 되는 퍼블릭 블록체인과 같은것이다.

하이브리드 블록체인에서는 사설 네트워크를 사용하여 데이터 블록을 생성한 다음 데이터 프라이버시를 훼손하지 않고 해당 데이터를 공개적으로 저장하는 방식으로 작동한다.

컨소시엄 블록체인과 달리 하이브리드 블록체인은 블록체인에 대한 유연한 제어를 제공한다. 즉 공유된 데이터에 대한 제어 정보는 컨소시엄 블록체인 보다 떨어진다.


----------------------------------------------------------------------


### 유망한 솔루션

비트코인과 이더리움과 같은 블록체인의 한계로 ‘확장성(Scalability)’이 두대되고 있다.

각 블록체인의 확장성 문제를 래선하기 위해 다양한 시도를 하고 있다.


비트코인은 대체로 블록체인 레이어 위에 또다른 레이어를 추가해 확장성문 제를 해결하려 한다.

그래서 비트코인은 레이어2라는 레이어위에 레이어를 추가하는 방식을 사용한다. 레이어2 솔루션은 블록체인에 올라갈 여러 트랜재션을 함께묶어서 블록체인에 하나의 트랜잭션으로 올리는것을 의미한다.

온체인과 오프체인 방식을 결합하여 탈중앙화를 유지하면서 동시에 확장성 문제를 해결할 수있을까?

이 경우 온체인으로부터 데이터를 동기화받는 오프체인의 소수 노드의 보안이 추약하고, 오프체인 노드에게 해킹 공격이 일어나 오염된데이터를 온체인에 올리게 될 수 도있다.

반대로 모든 노드가 데이터를 가지고 있다면 탈중앙성을 강화되겠지만, 합의에 도딜히기 까지 시간이 오래 걸리기 때문에 확장성이 떨어지고 체인재구성이 빈번하게 일어나 보안성 역시 떨어진다.

탈주앙화를 선택함으로써 발생하는 기회비용이 중앙화를 통해 얻을수 있는 편익과 동일함.


아직 트릴레마 세 요소를 모두 만족하는 블록체인은 등장하지 않았다.

----------------------------------------------------------------------

### 알트코인

알트코인 (Altcoin)은 대안(Alternative)과 화폐의 합성어로 비트코인을 개량한 암호화폐 전체를 의미한다.
비트코인은 프로그램 소스 코드를 공개하는 오픈소스이기 때문에 이를 참고해 새로운 암호화폐를 누구라도 개발할 수있다.

전 세계에 알트코인의 종류는 2만개가 넘고, 대부분은 블록체인 기술로 동작한다.


## 비트코인 캐시

대표적인 알트코인으로 설명하겠다.

### 비트코인 캐시의 등장배경

비크코인 캐시는 한정된 블록크기를 사용하는  비트코인을 하드포크하여 기존보다 2~8배까지 확장하였고 트랜잭션 속도를 올렸다.

비트코인의 탈중앙화를 지키고 10분이라는 생성주기를 조정하지 않은 상태에서 트랜잭션 속도를 높였다.

하지만 이런 비트코인 캐시에도 한계점이 있었는데

1. 제한된 확장성 : 기존 구조를 유지해서 개선은 되어도 제한적 일수 밖에없었다. 
2. 자원의 중앙화 : Pow가 자본 집중으로 인한 채굴권력 분산시키지 못한다는 점이 있다.

작업증명 합의에서 채굴 성공하려면 10분 안에 논스값을 찾아야하는데

컴퓨터 자원을 많이 가지고 있으면 확률적을 인센티브를 가져갈 확률이 올라간다. 즉 컴퓨텅자원의 농장화가 나타났고, 이러한 현상 때문에 자본이 더 모여들었다.

이미 이들은 50퍼정도의 해시파워를 담당하고 있고 이렇게 작정하고 51% 이상을 가지게 되면 데이터 무결성이 깨진다.

자원의 중앙화는 탈 중앙화와는 상반되는 개념이다.



### 라이트닝 네트워크


라이트닝 네트워크는 양방향 채널이라는 아이디어를 기반으로 매우 저렴한 비용으로 거의 즉각적인 거래가 가능한 비트코인 레이어2의 솔루션이다. 기본 블록체인과 마찬가지로 P2P 교환을 갖추고 있지만 지금 관리를 위임하지 않는 채널 네트워크에서도 돈을 교환할 수 있다. 거래는 다른 모든 사람의 잔액에 대한 인증 역할을 하는 첫 번째와 마지막을 제외하고는 오프체인이다.

라이트닝 네트워크는 기존 비트코인의 느린 속도를 해결하고 빠른속도로르 구현하기 위해 개별 거래를 별도의 채널에서 처리한 후 그 결과만 블록체인에 기록하는 방식으로 작동하는 알고리즘 이다. 라이트닝 네트워크는 탈중앙화와 보안을 기본으로 두고 확장성을 높이기 위한 작업으로 , 개별 노드 간에 일상적으로 반복되는 소액 거래 내역을 처리할 수 있도록 메인 블록체인 외부에 별도 채널을 구축한 오프체인 솔루션이다.

거래된 내용은 모든 노드의 승인을 받지 않고 께약 당사자들끼리 합의를 통해 확정되고 블록체인에 저장되지도 않는다. 반복적인 거래가 모두 끝난 후 오프체인을 닫을때 최종 거래내역만 블록체인에 저장된다. 승인 과정이 간단하고 반복적인 소액 거래가 블록체인에 저장되지 않으니 당연히 처리 속도는 빨라진다.

하지만 이것도 탈중앙화 문제를 완벽히 해결하지는 못하는데, 우선 블록체인 기술이 아니고 제삼자 세력이 필요하므로 확장성 진영에서 이러한 시스템을 좋게 보지는 않는다.

이미 서버 자체가 프라이빗 영역 급이라 해커가 해킹하는 것이 현재 기술로는 불가능해서 트릴레마를 해결했다고 하지만 탈중앙화는 다른 문제고, 검증 노드 갯수가 너무 소수라 비난을 받는다.

비트코인 DNA를 가진 어디든 사용하는데 문제가 없어서 확장성이 많이 개선될 것으로 보인다. 



## 플랫폼


### 카르다노

3세대 블록체인으로 지분 증명 메인넷 중 가장 탈중앙화가 잘 이루어진 메인넷이다. 블록체인 트릴레마의 해결을 위해 거래와 연산을 구분 하는 2개의 레이어를 사용해 스마트 컨트랙트 사용에 따른 트랜잭션 체증을 방지하였다. 또 우로보로스 지분증명이라는 합의 알고리즘을 사용해 예상되는 공격을 방지하여 안전성을 높였다.

하지만 스마트 컨트랙트 도입에서 어려움을 겪고 있다. 동시성 이슈로 인해서 스마트 도입시의 확장성 문제가 대두된다.

동시성(Concurrency) : 두 개의 작업이 동시에 발생하는 경우, 두 개 이상의 프로그램이나 작업을 동시에 비동기적으로 실행할 수 있고, 그 두 작업 모두 최종 결과에 영향을 주지 않는다.



### 알고랜드

블록체인의 트릴레마를 해결하기 위한 플랫폼을 위한 암호화폐로 알고랜드가 무허가형 순수지분증명(PPos) 합의 알고리즘을 통해 트릴레마를 해결하겠다고 밝혔다.

순수지분증명 방식은 첫 번째로 알고랜드 네트워크의 블록생성자가 토큰 보유자 중에서 무작위로 한 명을 선정하고, 두 번째 단게에서는 다시 무작위로 뽑힘 1천 명이 1단계에서 선정된 위원이 생성한 블록을 검증한다. 이 방식에서는 매번 새로운 사람이 블록을 채택하기 때문에 보안성을 갖추고 네트워크에서 전파되는 메시지는 위원회 선출을 통해 전파되지만, 공격자가 위원회를 생성하는 것 즉 단순히 체인을 만들기는 쉬우나 누가 다음 블록을 선택할 것인가에 따라서 거래의 유용성과 효율성이 달라진다.

순수지분증명 : 모든 토큰에 할당된 권리는 같으며, 누구나 블록 생성에 참여할 수 있다. 체인의 개념에서 이슈과 되는 포크가 일어날 수 없다.
즉각적인 제시와 합의 : 한 명의 사용자만이 블록생성하는 것이 아닌 전체가 블록을 선택하고 생성한다.빠르게
진화하는 합의 : 알고랜드의 합의는 99.9% 바로 이루어진다. 



알고랜드의 트릴레마 대안

비트코인의 과제중 하나는 확장성(Scalabliity)이다. 비트코인 트랜잭션이 최종 상태로 확정되려면 약간의 시간이 필요하다.
시간이 금인 현대에서 이것은 용납 불가능하다.

현재 시점 1000TRS 성능을 갖춘 원장이 필요한데, 확장성이 뛰어난 솔류션으로는 Dpos가 있다. 선별을 통해 정해진 검증자 그룹이 새 블록 추가를 처리한다. 이러한 주체를 21명으로 늘린다고 해도 여전히 중앙화 되었다고 볼 수 있는데

알고랜드는 어떻게 탈중앙화를 유지하면서 확장성을 달성할 까?

임의성을 통해 블록체인 삼중고를 해결한다.

블록추가 작업을 검증자 초점에서 생각한다. 블록체인 주 목표는 분산화 수준을 유지하고, 확장성을 허용하는 방식으로 검증자에게 블록 검증을 위탁하는 것이다.

임의성(Randomness)은 목표로 하는 분산화 수준을 달성하고 네트워크가 51% 공격에 당하지 않도록 해주는 강력한 도구이다.

순수지분증명(Pure Proof of Stake, PPoS)



시스템 동작방식

알고랜드에서는 전통에서 벗어난 작업을 수행한다.

토큰 보유자는 무작위로 자신을 선택한다. 생각해보면 끔찍한 아이디어로 보이지만 만약 악성 공격자라고 가정하고 생각해보면 검증위원회의 일원이 되기 위해 계속해서 자신을 검증자로 선정할 것이다. 



Safety 와 Liveness


Safety : 시스템에 나쁜 일이 발생하지 않는다는 의미이며, 모든 정상적인 참여자는 같은 상태에 동의하여야하고, 그 상태는 유효해야한다.

Liveness : 시스템은 항상 살아 있어야 하고, 결국에는 어떤 상태에 동의하여야 하고, 모든 참여자는 동의한 상태에 도달해야한다.



FLP Impossibility


우선 아무 문제 없는 두 노드가 서로 다른 값으로 합의하면 안된다.

다른 값을 합의했다는 것은 블록체인 관점에서 보면 같은 높이에 서로 다른 블록이 생성됐다는 것.

이런 특성을 분산시스템에서는 Safety 라고한다.

합의는 언젠가 이루어 져야한다. 노드 간의 메시지를 주고받으며 각 노드의 상태를 변경시키며 이루어진다. 이때 문제없는 노드들은 무한 루프에 빠지지 않고 반드시 상태 변경이 종료돼야한다. 모든 노드가 문제없이 합의를 할 수 있으면 시스템은 Livenness 가 보장된다고 한다.

Liveness over Safety

비트코인이 사용하는 합의 알고리즘은 사토시 나카모토가가 제안해서 Nakamoto Consensus 라고 불린다.

언제나 더 어려운 문제를 푼 체인이 있으면, 그 체인을 유요한 체인으로 판단한다.

지금 있는 체인보다 더 긴 체인을 만들 해시 파워만 있으면, 언제든지 현재 합의된 블록을 다른 블록으로 대채할 수 있다.

이런 방식을 블록체인에서는 완결성(Finality)가 보장되지 않는다고 말하고, FLP Imposssibility에서는 Liveness를 위해서 Safety를 포기했다고 말한다. 

Linveness를 중시하는 나카모토 합의에서는 출발한 합의 알고리즘들은 한정적인 상황에서 Safety를 보장할 방법을 추가하는 방식으로 발전했다. 이더리움에서 구현되고 있는 Casper ,the Friendly Finality Gadget이 대표적이다. Casper는 기존의 PoW로 Liveness를 보장하며 블록을 생성하지만, 50 블록 마다 투표하여 Safety가 보장되는 지점을 만든다.

Safety over Liveness

이와 반대로 Safety를 중시하는 합의 알고리즘도 있다. 전통적으로 분산 시스템에서 연구되던 PBFT에 기반한 BFT 계열 합의 알고리즘들이 이쪽에 속한다. Cosmos에서 사용하는 Tendermint가 대표적인 Safety를 보장하는 BFT 알고리즘이다.

BFT는 (Byzantine Fault Tolerance) 알고리즘은 컴퓨터 시스템의 상태로 분산 컴퓨팅 구성요소가 실패할 시스템, 불완전한 구성 요소가 실패했는지 여부에 대한 정보이다.

Tendermint는 하나의 라운드가 Propose, Prevote,Precommit(제안,사전 메모,사전 커밋) 3단계로 나뉜다. 이중 Prevoteㅇhk Precomit 스텝에서 각각 2/3 +1 개 이상 모아야 합의가 이루어진다. 합의에 2/3+1 개 이상의 동의가 필요하기 때문에 어떤 상황에서도 서로 다른 두 블록이 동시에 생성되는 일은 없다. 하지만 전송한 메시지가 시간 안에 도달하는 것을 보장하지는 못하는 비동기 네트워크에서는 합의가 이루어지지 않아 블록이 생성되지 않을 수 있다. = Liveness가 보장 되지 않는다.

FLP Impossibility가 증명하듯 Safety가 보장되는 경우 어떤 방법을 사용해도 비동기 네트워크에서 LIveness를 보장할 수 없다. 그래서 BFT 계열에서는 다른 네트워크 모델에서 Liveness가 보장됨을 보장한다.

비동기 네트워크 모델에서는 메시지가 전송되는 것이 보장되는 시간이 없다. 이는 메시지가 무한한 시간 후에 도착하는 것도 가정해야하고 다시 말해 전송한 메시지가 도착하지 안흔 것을 가정해야 한다.. 그렇다고 해서 정해진 시간 안에 메시지 전달이 보장되는 동기 네트워크 모델을 사용할 수는 없다. 이는 인터넷 규모의 네트워크에서는 비현실적인 가정이고, 이런 가정에서 Liveness를 증명하는 것은 아무 의미 없기 때문이다. 그래서 Tendermint는 정해진 시간 안에 메시지가 도달하는 것이 보장되지만 그 정해진 시간을 알 수 없다는 Partial Synchronous Network Model를 사용한다.

Partial Synchronous Network는 정해진 시간 내에 메시지가 도착하는 것이 보장되는 모델이다. 다만 이 정해진 시간이 무엇인지 노드는 알지 못하며, 이는 꽤 현실적인 모델이다. 현실의 네트워크도 Omissin Failure가 발생하지 않는 한 언젠가는 메시지가 도착하기 때문이다. 

BFT 계열의 합의 알고리즘은 블록 생성을 위해 2번의 투표를 모아야한다. 비록 Partial Synchronous Network Model에서는 언젠가 합의도리 것이 보장되지만 최악의 경우 몇번의 라운드 동안 새 블록이 생성되지 않는 경우도 생긴다. = TPS 저하 초래
