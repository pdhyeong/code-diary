### 가상 메모리

가상 메모리는 주기억장치의 이용 가능한 기억 공간보다 훨씬 큰 주소 지정을 할 수 있도록 한 개념으로 

하나의 프로세스 전체가 한 번에 주기억장치 내에 존재하지 않고 일부만 있어도 수행하게 하는 방법을 제공해준다.

가상 주소 공간을 구성 하는 것을 가상 메모리라고 하고 실제주소 공간을 구성하는 것을 주기억장치 또는라한다.

실제 물리적 저장 공간과 가상 저장 공간 간의 사상(mapping)은 운영체제에의해서 수행된다.

가상 주소공간을 V라고하고 특정 컴퓨터에서 사용하는 실제 주소공간을 E이라고 할때 

이것들의 관계를 함수로 표현하면 F: V->R로 정의된다.

즉, 프로그램 상의 주소가 x가 주기억장치 상의 주소 y에 적재되어 있다면, 이 y는 y=F(x)가 된다.

-------------------------------------------------

### 동적 주소의 변환

수행 중인 프로세스가 참조하는 주소를 가상주소라고 하며, 주기억장치 상에서 이용할 수 있는 주소는 실제 주소라고 한다.

이 둘이 사상이 되지 않는다면 가상 메모리를 사용하는 이유가 사라진다.

이 주소 사상 기법에는 동적 주소 변환(dynamic address tranflation)기법이 있는데

프로세스가 수행될 때 가상 주소를 실제 주소로 변환하는 대표적인 메커니즘이다.

가상 주소들은 반드시 연속적일 필요가 없으며 이는 **인위적 연속성(artificial coutinuity)**라고 한다.

-------------------------------------------------

### 블록 사상

동적 주소 변환 기법에서는 어떤 가상기억 주소에 대한 주기억장치 내의 존재 여부와 존재할 경우에 주기억장치의 어디에 위치하는가를 

나타내기 위한 대응관계 테이블을 유지,관리한다.

사상의 횟수는 너무 늘리지 않게하기 위해 바이트나 워드 단위가 아닌 블록 단위로 하는데 여기서 이 블록은

가상 가상 메모리에 대한 분할 단위를 의미한다.

블록 크기가 크면 클수록 사상정보를 기억하는 데 필요한 주기억장치의 양은 더욱 작아지게 된다.

크기를 크게할 수록 기억장치의 오버헤드는 낮아지지만 , 대형 블록은 보조기억장치와 주기억장치 간의 데이터 전송에 많은 시간을 요한다.

또 많은 실기억 공간의 소모와 주기억장치를 공유하는 프로세스수에도 제한을 받는다.

블록을 같은 크기로 할 때 이를 **페이지(page)라고 하며**, 페이지와 관련된 가상 메모리 구성을 페이징(paging)이라고한다. 반면,

블록을 서로 다른 크기로 할 때 세그먼트(segment)라고 한다.

이와 관련된 가상 메모리 구성을 **세그먼테이션(segmentation)** 이라고 한다.

어떤 시스템에서는 여러 크기의 세그먼트를 다시 일정한 크기의 페이지로 재구성함으로써 두 가지 방법을 결합하여 쓰고도 있다.

블록 사상 시스템 (block mapping system)에서의 가상주소는 2차원 배열의 원소형태로 표기되는데,

어떤 항목을 참조하려면 그 항목이 속해있는 블록과 그블록의 시작에서부터 해당 항목까지의 변위(displacement)를 나태내야한다.

따라서 가상 주소는 v = (b,d)로 표시되는데 b는 참조될 항목이 속해있는 블록의 번호이고, d는 블록의 시작점으로부터의 변위이다.

각 프로세스는 주기억장치 내의 시스템에 의해 유지되는 고유의 블록 사상테이블(block mapping table)을 유지 관리해야한다.

------------------------------------

### 블록 사상테이블 동작방식

처리장치 내에 있는 블록 테이블 시작점 레지스터(block table origin register)라고 하는,

전용 레지스터에는 블록 사상 테이블의 실제 주소 a가 들어 있다.

프로레슷의 각 블록은 블록 사상 테이블에 하나의 항목을 가지며 각 항목은 블록 0 ,블록 1등의 순서로 배열 되어있다.

블록 사상 테이블 내에서 블록 b의 실제 주소는 블록 번호 b를 블록 사상테이블의 시작 주소a를 더함으로써 얻는다.

이 항목은 블록b의 주기억 장치에서의 실제 주소 b'를 가지고 있으며, 이 실제 주소b'에 변위 d를 더함으로써,

원하는 실제 주소 r = b' + d를 구한다.

하지만, 블록사상은 동적으로 이루어져 사상에 소요되는 대가가 너무 커서,

가상메모리에서 얻어지는 이익을 상쇄할 정도의 성능 저하를 초래할 수도 있다는 것을 알아야한다.
