### 입출력 프로그래밍

대부분의 컴퓨터의 있어서 입출력은 대부분 중앙처리장치와 비동기적(asynchronus)으로 수행된다.

즉 , 중앙처리장치와 입출력장치에 대한 작동이 독립적이다.

입출력장치는 중앙처리장치와 비교할 때 데이터 처리시간이 일정하지 않다.

입출력장치와 중앙처리장치 간의 상호 작용에는 세심한 주의가 필요하며, 이로 인해 입출력 프로그래밍이 필요한 것.

-------------------------------------------

### BIOS(basic input/output system)

컴퓨터의 전원을 켜 파워 공급이 시작되면 메인보드와 CPU파워가 준비되었다는 싱호를 보내고, 컴퓨터는 수행할 명령과 코드에 언제라도 접근할 수 있어야한다.

그 정보는 ROM 칩에 저장되어야 한다.

이유는 하드 드라이브가 고장나도 접근해야하기 때문에

컴퓨터가 ROM에서 얻는 정보를 BIOS라 부르며, BIOS는 부트 프로세스를 실행시키는 명령어들을 포함하고 있다.

----------------------------------------------

### 부트 진행 과정(boot process)

부트 절차는 컴퓨터, BIOS,하드웨어 제조사에 따라 약간의 차이가 있지만, 대부분의 컴퓨터에서는 다음 절차와 같이 진행된다.

```
1. 컴퓨터 가동을 위해 파워 버튼을 누르면 부트 로더 초기화
2. POST(Power-On- Self-Test) 수행 시작
3. 다른 BIOS들이 가동을 위해 초기화
4. 유저 필요에 따라 BIOS접근 비밀키 입력 요구
5. 메모리 테스트가 수행되고 파라미타들이 세트된다.
6. Plug & Play 디바이스들이 초기화 된다.
6. DMA(Direct Memory Access) 채널을 위한 자원들과 IRQ(Interrupt Request)가 할당
7. OS 초기화
```

----------------------------------------------

### POST(Power-On Self-Test)

POST는 다음과 같은 일을 한다.

```
1. BIOS의 완벽한 보전 확인
2. 주기억장치의 위치 결정, 확인 및 크기결정
3. 시스템 버스와 시스템 디바이스 결정 , 시작
4. 요구되는 다른 BIOS들의 시작 허용
5. 사용자에게 BIOS시스템 구성 페이지엣 접근할 수 있느 권한 부여
6. 부트 디바이스 위치 및 부트 파일을 가진 디바이스 찾기
7. 운영체제에 의해 요구되는 그 외 작동 준비 관련 작업 수행
```

----------------------------------------------------

### 버퍼링

입출력장치와 보조기억장치 의 기계적 요인 때문에 중앙처리장치 입장에서는 매우 느린 속도로 작동되는데,

입출력장치의 느린 속도를 보완하기 위한 방법으로 버퍼링이 존재한다.

**버퍼링** : 한 레코드가 읽혀 중앙처리장치가 그것에 대한 여산을 시작함과 동시에 입력장치가 곧 다음에 필요한 레코드를 미리 읽어서 주기억장치에 저장해서
필요한 레코드를 기다리지 않게 하는 일련의 과정

단계는 다음과 같다.

```
1. 중앙처리장치가 출력한 데이터를 버퍼에 채운다.
2. 버퍼가 다 차면 채널에게 출력을 지시하고, 일을 계속한다.
3. 채널은 출력을 수행함으로써 버퍼을 지운다.
4. 출력을 완료함으로써 버퍼를 비우면 중앙처리장치에게 알린다.
```


효율적인 처리를 위하여 하나의 입력장치 또는 출력장치에 두 개 이상의 버퍼를 사용할 수 있는데, 이를 다중버퍼라고 한다.

다중버퍼는 많은 양의 주기억장치가 버퍼에 할당되어 이용 가능한 주기억장치의 크기가 줄어든다.

단계는 다음과 같다.
```
1. 중앙처리장치가 버퍼A를 채운다.
2. 다 채우면 채널에게 버퍼A 출력을 지시
3. 버퍼A에 대한 출력과는 무관하게 버퍼B를 채운다.
4. 채널은 버퍼A를 비운다.
5. 채널은 버퍼A를 비우면 다 비웠음을 중앙처리장치에 알린다.
6. 중앙처리장치는 다시 버퍼A를 채우고 채널은 버퍼B를 비운다.
```

이와 같이 행하며 프로그램 대기시간을 줄일 수 있다.

-------------------------------------------------------

### 스풀링

스풀링(Simultaneous Peripheral Operation Online)의 첫 글자를 따서 만든말이며,

다수의 프로세스들이 입출력장치를 서로 요구하거나 실제로 그 장치의 수가 제한되어 있을때 이들에 대한 공유를 가능하게 하기 위해 가상 장치를 각 프로세스에 제공하는 개념.

보통 가상 장치들은 스풀링 통제 프로그램에 의해 디스크에 나타나게 되는데, 이것 때문에 다수의 프로세스들은 각기 독립적인 입출력장치를 가지는 셈이 된다.

작업들이 들어오는 입력장치의 특성상 FCFS(First Come First Served)가 지켜져야만 하기 때문에 우선순위에 따라 작업스케쥴링이 가능하다.

---------------------------------------------------

### 채널(Chennel)

중앙처리장치의 속도와 입출력장치의 속도는 차이가 있기 때문에 입출력장치와 중앙처리장치를 직접 연결하는것은 효율적이지 못하다.

입출력장치와 중앙처리장치 사이에 입출력 전담 처리기인 입출력 채널을 두어 컴퓨터 시스템을 구성한다.

채널은 종류가 다양하여, 간단한 처리기에서부터 중앙처리장치와 거의 동일한 것까지 있다.

선택채널(select channel) 은 여러 개의 입출력장치가 연결되어도 한 번에 단 하나의 ㅇ입출력장치만을 선택적으로 지원한다.

멀티플렉서 채널(multiplexer channel)은 키보드나 프린터와 같은 비교적 전송속도가 느린 입출력장치를 제어하기 위한 채널로 다수의 저속도 입출력장치가

단일한 데이터 경로를 공유하면서 데이터를 전송한다.

즉 여러 개의 저속도 입출력장치가 멀티플렉서 채널에 연결되어 시분할 형태로 제어된다.

----------------------------------------------------

### 인터럽트

인터럽트(interrupt)는 시스템에 예기치 않은 상황이 발생하였을 때, 그것을 운영체제에 알리기 위한 메커니즘이다.

IBM 계열의 기계에는 원인에 따라 6가지 인터럽트가 있는데

다음과 같다

```
1. 외부 인터럽트 : 시스템 다이머에서 일정한 시간이 만료된 경우나 오퍼레이터가 콘솔 상의 인터럽트 키를 입력한 경우, 다중 처리 시스템에서 다른 처리기로부터 신호가 온경우

2. 입출력 인터럽트 : 해당 입출력 하드웨어가 주어진 입출력 동작을 완료하거나 오류가 발생했을때 중앙처리장치에 대해 요청하는 경우

3. SVC 인터럽트 : 사용자 프로그램을 수행하는 과정에서 입출력 수행, 기억장치 할당, 오퍼레이터의 개입 요구 등을 위하여 실행 중 프로그램이 SVC 명령을 수행하는 경우

4. 기계 검사 인터럽트 : 컴퓨터 자체 내의 기계적인 장애나 오류

5. 프로그램 에러 인터럽트 : 주로 프로그램 실행 오류로 인해 발생

6. 재시작 인터럽트 : 오퍼레이터가 콘솔상의 재시작 키를 누를 때 일어난다.
```

#### 인터럽트의 구조 및 처리

일반적으로 중앙처리장치는 입터럽트 발생을 알리는 신호를 받으면 프로그램 카운터의 내용과 프로그램 수행 상태에 관한 모든 정보를 저장한 후에, 문제의 해결을 위한 처리 과정이

기술된 인터럽트 처리기(interrupt handler)의 시작 주소를 프로그램 카운터로 옮기고, 인터럽트 루틴을 수행한다.

처리과정을 설명하면 다음과 같다.

```
1. 중앙처리장치가 실행하는 중 인터럽트가 발생하였다. 이 경우 현 상태에서의 프로그램 카운터와 프로그램의 다음 수행에 도움이 되거나 필요한 정보를 주기억장치의 일정한 지역에 보관
2. 해당 인터럽트에 대처하기 위한 인터럽트 처리 루틴으로 제어를 이동시켜, 인터럽트 해결
3. 인터럽트 처리 루틴의 수행을 완료
4. 인터럽트가 발생했던 지점으로 되돌아와 보관해 놓은 정보를 이용한다.
5. 원래 수행 중이었던 프로그램을 처리한다.
```

인터럽트 된 실행 중인 프로그램의 상태를 기억시켜 두고 제어권을 인터럽트 처리 루틴에게 넘기는 작업을 문맥교환(context switching)이라고 한다.
